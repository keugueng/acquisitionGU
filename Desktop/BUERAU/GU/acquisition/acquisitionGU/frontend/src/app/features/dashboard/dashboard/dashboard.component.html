<div class="dashboard-container">
  <!-- Stats Cards -->
  <div class="stats-grid">
    <mat-card class="stat-card">
      <mat-card-content>
        <div class="stat-header">
          <h3>Total Dossiers</h3>
          <mat-icon>folder</mat-icon>
        </div>
        <div class="stat-content">
          <span class="stat-value">{{ stats.totalDossiers }}</span>
          <span class="stat-trend" [class.positive]="stats.dossiersTrend > 0" [class.negative]="stats.dossiersTrend < 0">
            {{ stats.dossiersTrend > 0 ? '+' : '' }}{{ stats.dossiersTrend }}%
          </span>
        </div>
        <div class="stat-footer">
          <span>{{ stats.newDossiers }} nouveaux ce mois</span>
        </div>
      </mat-card-content>
    </mat-card>

    <mat-card class="stat-card">
      <mat-card-content>
        <div class="stat-header">
          <h3>Paiements</h3>
          <mat-icon>payments</mat-icon>
        </div>
        <div class="stat-content">
          <span class="stat-value">{{ stats.totalPaiements | currency:'XAF':'symbol-narrow':'1.0-0' }}</span>
          <span class="stat-trend" [class.positive]="stats.paiementsTrend > 0" [class.negative]="stats.paiementsTrend < 0">
            {{ stats.paiementsTrend > 0 ? '+' : '' }}{{ stats.paiementsTrend }}%
          </span>
        </div>
        <div class="stat-footer">
          <span>{{ stats.paiementsPending }} en attente</span>
        </div>
      </mat-card-content>
    </mat-card>

    <mat-card class="stat-card">
      <mat-card-content>
        <div class="stat-header">
          <h3>Logements</h3>
          <mat-icon>home</mat-icon>
        </div>
        <div class="stat-content">
          <span class="stat-value">{{ stats.availableLogements }}</span>
          <span class="stat-trend" [class.positive]="stats.logementsTrend > 0" [class.negative]="stats.logementsTrend < 0">
            {{ stats.logementsTrend > 0 ? '+' : '' }}{{ stats.logementsTrend }}%
          </span>
        </div>
        <div class="stat-footer">
          <span>{{ stats.totalLogements }} au total</span>
        </div>
      </mat-card-content>
    </mat-card>
  </div>

  <!-- Charts Section -->
  <div class="charts-section">
    <mat-card class="chart-card">
      <mat-card-header>
        <mat-card-title>Évolution des dossiers</mat-card-title>
        <mat-form-field appearance="outline">
          <mat-select [(value)]="selectedPeriod" (selectionChange)="onPeriodChange()">
            <mat-option value="week">Cette semaine</mat-option>
            <mat-option value="month">Ce mois</mat-option>
            <mat-option value="year">Cette année</mat-option>
          </mat-select>
        </mat-form-field>
      </mat-card-header>
      <mat-card-content>
        <div class="chart-container">
          <ngx-charts-line-chart
            [results]="dossiersChartData"
            [scheme]="colorScheme"
            [gradient]="true"
            [xAxis]="true"
            [yAxis]="true"
            [showXAxisLabel]="true"
            [showYAxisLabel]="true"
            [xAxisLabel]="'Période'"
            [yAxisLabel]="'Nombre de dossiers'"
            [autoScale]="true"
            [timeline]="false">
          </ngx-charts-line-chart>
        </div>
      </mat-card-content>
    </mat-card>

    <mat-card class="chart-card">
      <mat-card-header>
        <mat-card-title>Répartition des paiements</mat-card-title>
        <button mat-button color="primary" (click)="viewPaymentDetails()">Voir détails</button>
      </mat-card-header>
      <mat-card-content>
        <div class="chart-container">
          <ngx-charts-pie-chart
            [results]="paiementsChartData"
            [scheme]="colorScheme"
            [gradient]="true"
            [labels]="true"
            [doughnut]="true">
          </ngx-charts-pie-chart>
        </div>
      </mat-card-content>
    </mat-card>
  </div>

  <!-- Recent Activities -->
  <mat-card class="activities-card">
    <mat-card-header>
      <mat-card-title>Activités récentes</mat-card-title>
    </mat-card-header>
    <mat-card-content>
      <mat-list>
        <mat-list-item *ngFor="let activity of recentActivities">
          <mat-icon matListItemIcon [ngStyle]="{'color': activity.iconColor}">{{ activity.icon }}</mat-icon>
          <div matListItemTitle>{{ activity.title }}</div>
          <div matListItemLine>{{ activity.description }}</div>
          <span matListItemMeta>{{ activity.time | date:'short' }}</span>
        </mat-list-item>
      </mat-list>
    </mat-card-content>
  </mat-card>
</div>
